<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap core CSS -->
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!--Font Awesome -->
    <link rel="stylesheet" href="/font-awesome-4.6.3/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet">



    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.34.5/css/bootstrap-dialog.min.css" rel="stylesheet" type="text/css" />

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="/bootstrap/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for wbr -->
    <link href="/css/app.css?0002" rel="stylesheet">
    <link href="/css/buttons.css?0002" rel="stylesheet">

    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/fav/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>



    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top header_bar">
        <div class="container">

            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Wbr</a>
                <p class="hidden-sm hidden-xs">Find speakers with interesting talks</p>

            </div>

        </div>
    </nav>


    <div class="container main_content">


        <div class="row">

            <div class="col-md-9">
                <h2>Showing <span id='spkCount'></span><span id="filterText"></span></h2>

                <p id="filterPills"></p>



                <div id="map_canvas" style="height:680px"></div>
                <p style='margin-top:10px; border:1px solid #ddd; border-radius:4px; padding:5px; background-color:#fcfcfc;'>
                    <img src="/images/SpeakernetSymbol_32x32_native.png" /> Speakers in your chosen region &nbsp;&nbsp;&nbsp;
                    <img src="/images/SpeakernetSymbol_32x32_native_red.png" /> Speakers that will come to your chosen region
                </p>

            </div>

            <div class="col-md-3">
                <h2>Filter the Speakers</h2>
                <form class="form-horizontal talks-selector" method="post" action="/talks/filtered">
                    <input type="hidden" name="_token" value="3WvFCltl0eN7ybCmPM5r0n0W8TjgfP5kdIG8lGsL">


                    <div class="form-group">
                        <label class="col-sm-4 control-label" for="category">Category</label>
                        <div class="col-sm-8">
                            <select class="form-control input-sm" id="category" name="category">
                                <option value="">Any</option>
                                <option value='13'>
                                    Business</option>
                                <option value='2'>
                                    Charity</option>
                                <option value='7'>
                                    Entertainment</option>
                                <option value='4'>
                                    Health</option>
                                <!-- <option value='1'>
                                    History</option>
                                <option value='8'>
                                    Hobbies</option>
                                <option value='12'>
                                    Humanities</option>
                                <option value='5'>
                                    Life Skills</option>
                                <option value='11'>
                                    Media</option>
                                <option value='10'>
                                    Nature</option>
                                <option value='6'>
                                    Science</option>
                                <option value='3'>
                                    Sports</option>
                                <option value='9'>
                                    Travel</option>
                                <option value='0'>
                                    Uncategorised</option> -->
                            </select>
                        </div>
                    </div>

                    <!--
                    <div class="form-group">
                        <label class="col-sm-4 control-label" for="fee">Fees</label>
                        <div class="col-sm-8">
                            <select class="form-control input-sm" id="fee" name="fee">
                                <option value="">Any</option>
                                <option value='1'>
                                    Free</option>
                                <option value='2'>
                                    Expensed</option>
                                <option value='3'>
                                    Paid</option>
                                <option value='4'>
                                    Unknown</option>
                            </select>
                        </div>
                    </div> -->


                    <div class="form-group">
                        <label class="col-sm-4 control-label" for="region">Region</label>
                        <div class="col-sm-8">
                            <select class="form-control input-sm" id="region" name="region">


                                <option class="level-0" value="" selected="selected">
                                    Anywhere
                                </option>


                                <option class="level-0" value="ENG">
                                    Gothenburg
                                </option>


                                <option class="level-0" value="SE">
                                    &nbsp;
                                    Los Angeles
                                </option>


                                <option class="level-0" value="SW">
                                    &nbsp;
                                    Bangalore
                                </option>


                                <option class="level-0" value="EE">
                                    &nbsp;
                                    Chennai
                                </option>

<!--
                                <option class="level-0" value="LO">
                                    &nbsp;
                                    London
                                </option>


                                <option class="level-0" value="WM">
                                    &nbsp;
                                    West Midlands
                                </option>


                                <option class="level-0" value="EM">
                                    &nbsp;
                                    East Midlands
                                </option>


                                <option class="level-0" value="YH">
                                    &nbsp;
                                    Yorkshire &amp; Humber
                                </option>


                                <option class="level-0" value="NW">
                                    &nbsp;
                                    North West
                                </option>


                                <option class="level-0" value="NE">
                                    &nbsp;
                                    North East
                                </option>


                                <option class="level-0" value="SC">
                                    Scotland
                                </option>


                                <option class="level-0" value="ESC">
                                    &nbsp;
                                    Eastern Scotland
                                </option>


                                <option class="level-0" value="WSC">
                                    &nbsp;
                                    Western Scotland
                                </option>


                                <option class="level-0" value="WA">
                                    Wales
                                </option>


                                <option class="level-0" value="NI">
                                    Northern Ireland
                                </option> -->
                            </select>
                        </div>
                    </div>

                </form>

            </div>
        </div>


    </div>


    </div>
    <!-- /container -->

    <div class="js-cookie-consent cookie-consent">

        <span class="cookie-consent__message">
            Wbr will be sending cookies to your browser to track your activity on this site
        </span>

        <button class="js-cookie-consent-agree cookie-consent__agree">
            I'm ok with this
        </button>

    </div>

    <script>
        window.laravelCookieConsent = (function() {

            const COOKIE_VALUE = 1;

            function consentWithCookies() {
                setCookie('speakernet_cookie_consent', COOKIE_VALUE, 7300);
                hideCookieDialog();
            }

            function cookieExists(name) {
                return (document.cookie.split('; ').indexOf(name + '=' + COOKIE_VALUE) !== -1);
            }

            function hideCookieDialog() {
                const dialogs = document.getElementsByClassName('js-cookie-consent');

                for (let i = 0; i < dialogs.length; ++i) {
                    dialogs[i].style.display = 'none';
                }
            }

            function setCookie(name, value, expirationInDays) {
                const date = new Date();
                date.setTime(date.getTime() + (expirationInDays * 24 * 60 * 60 * 1000));
                document.cookie = name + '=' + value + '; ' + 'expires=' + date.toUTCString() + ';path=/';
            }

            if (cookieExists('wbr_cookie_consent')) {
                hideCookieDialog();
            }

            const buttons = document.getElementsByClassName('js-cookie-consent-agree');

            for (let i = 0; i < buttons.length; ++i) {
                buttons[i].addEventListener('click', consentWithCookies);
            }

            return {
                consentWithCookies: consentWithCookies,
                hideCookieDialog: hideCookieDialog
            };
        })();
    </script>

    <footer class="container">
        <div class="row">
            <div class="col-md-6">
                <p>Site by <a href="http://wbr.mobi">Wbr</a> | Copyright 2021 © Wbr Ltd</p>
            </div>
            <div class="col-md-6 text-right">
                <ul class="list-inline footer-menu">
                    <li><a href="https://donations.wbr.co.uk">Donate</a></li>
                    <li><a href="/pages/terms">Terms</a></li>
                    <li><a href="/pages/privacy">Privacy</a></li>
                    <li><a href="/pages/contact">Contact Us</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->

    <script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script>
        window.jQuery || document.write('<script src="/bootstrap/js/vendor/jquery.min.js"><\/script>')
    </script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.34.5/js/bootstrap-dialog.min.js"></script>

    <script src="/bootstrap/js/ie10-viewport-bug-workaround.js"></script>
    <!--before yield -->
    <script>
        var map;
        var speaker_markers = new Array();
        var speaker_pins = new Array();
        var infowindow;
        var mapScheme;

        window.onload = function() {
            initMap();
            applyFilter('');
            monitorFilters(map);
        };

        function initMap(details) {

            var myOptions = {
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                mapTypeControl: true,
                scaleControl: true,
                streetViewControl: false,
                center: {
                    lat: 53.802,
                    lng: -1.261
                },
                zoom: 7,
                draggableCursor: 'default',
                styles: mapScheme,
            };

            map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

            infowindow = new google.maps.InfoWindow({
                content: 'Please wait',
                pixelOffset: new google.maps.Size(0, -16),
            });

            recenter(map);
            return map;
        }

        function livloc() {

            var locations = <?php print_r(json_encode($vehicles)); ?>;

            var mymap = new GMaps({
                el: '#mymap',
                lat: 57.708870,
                lng: 11.974560,
                zoom: 6
            });
            $.each(locations, function(index, value) {
                mymap.addMarker({
                    lat: value.lat,
                    lon: value.lon,
                });
            });
        }

        function loadMarkers(map) {
            infowindow.close();

            // clear any current markers
            speaker_pins.forEach(function(marker) {
                marker.setMap(null);
            });
            speaker_pins = [];
            speaker_markers = [];

            axios.get('https://wbr.co.uk/map/speakers')
                .then(function(response) {

                    response.data.forEach(function(wbr, index) {
                        addSpeakerMarker(wbr, infowindow, index);
                    });

                    updateSpeakerCount(response.data.length);
                })
                .catch(function(response) {
                    console.log(response);
                });

        }

        function updateSpeakerCount(count) {
            document.getElementById('spkCount').textContent = count;
            $('#spkCount').addClass('spkCountChanged');
            setTimeout(function() {
                $('#spkCount').removeClass('spkCountChanged');
            }, 3000);
        }

        function addSpeakerMarker(wbr, infowindow, index) {
            var dodge = new Array(
                [0, 0], [+0.006, -0.01], [-0.006, +0.01], [-0.006, -0.01], [+0.006, +0.01], [+0.006, 0], [+0, +0.01], [+0, -0.01], [-0.006, 0]
            );

            region = document.getElementById('region').value

            if (region == '' || wbr.regioncode == region) {
                icon = '/images/SpeakernetSymbol_32x32_native.png'

            } else {
                icon = '/images/SpeakernetSymbol_32x32_native_red.png'
            }

            var pin = new google.maps.Marker({
                position: {
                    lat: parseFloat(wbr.latitude) + parseFloat(dodge[index % 9][0]),
                    lng: parseFloat(wbr.longitude) + parseFloat(dodge[index % 9][1])
                },
                map: map,
                icon: icon
            });

            speaker_markers.push(wbr);
            speaker_pins.push(pin);

            google.maps.event.addListener(pin, 'click', function(ev) {
                infowindow.setPosition(ev.latLng);
                infowindow.open(map);
                infowindow.setContent(wbr.wbr.replace(/\b\w/g, function(l) {
                    return l.toUpperCase()
                }));
                fillCard(wbr, map, infowindow);
            }, {
                passive: true
            });

        }

        function fillCard(wbr, map, infowindow) {
            url = '/map/wbr/' + wbr.id + '?lat=' + map.getCenter().lat() + '&lng=' + map.getCenter().lng() + '&z=' +
                map.getZoom();

            axios.get(url)
                .then(function(response) {
                    infowindow.setContent(response.data);
                })
                .catch(function(response) {
                    console.log(response);
                });

        }

        function monitorFilters(map) {
            $('#category').on('change', function() {
                applyFilter('cat=' + this.value);
            });

            $('#fee').on('change', function() {
                applyFilter('fee=' + this.value);
            });

            $('#region').on('change', function() {
                applyFilter('region=' + this.value);
            });

            $('#recency').on('change', function() {
                applyFilter('recency=' + this.value);
            });

            $('#notice').on('change', function() {
                applyFilter('notice=' + this.value);
            });

            $('#online').on('change', function() {
                applyFilter('online=' + this.value);
            });
        }

        function applyFilter(filter) {
            axios.post('/filter?' + filter)
                .then(function(response) {
                    loadMarkers(map);
                    setFilters(response.data);
                    setFilterString(response.data);
                });
        }

        function setFilters(filters) {
            filterItems = (Object.keys(filters));
            var filterString = '';
            filterItems.forEach(function(item) {
                filterString += '<span class="filterpill">' + filters[item] +
                    '<a href="#" onclick="removeFilter(\'' + item + '\')">X</a></span>';
            });

            document.getElementById('filterPills').innerHTML = filterString;
        }

        function setFilterString(filters) {
            if (Object.keys(filters).length > 0) {
                document.getElementById('filterText').innerHTML = ' speakers matching your filters';
            } else {
                document.getElementById('filterText').innerHTML = ' speakers, with no filters applied';
            }
        }

        function removeFilter(filter) {
            axios.delete('/removefilter/' + filter)
                .then(function(response) {
                    loadMarkers(map);
                    setFilters(response.data);
                    setFilterString(response.data);
                    $('#' + filter).get(0).selectedIndex = 0;
                });
        }

        mapScheme = [{
            "featureType": "administrative.country",
            "elementType": "labels.text",
            "stylers": [{
                "visibility": "off"
            }]
        }, {
            "featureType": "administrative.land_parcel",
            "elementType": "geometry.fill",
            "stylers": [{
                "saturation": "100"
            }, {
                "visibility": "on"
            }]
        }, {
            "featureType": "landscape",
            "elementType": "all",
            "stylers": [{
                "hue": "#FFBB00"
            }, {
                "saturation": 43.400000000000006
            }, {
                "lightness": 37.599999999999994
            }, {
                "gamma": 1
            }]
        }, {
            "featureType": "landscape.natural.landcover",
            "elementType": "geometry.fill",
            "stylers": [{
                "lightness": "-45"
            }, {
                "saturation": "-66"
            }]
        }, {
            "featureType": "poi",
            "elementType": "all",
            "stylers": [{
                "hue": "#00FF6A"
            }, {
                "saturation": -1.0989010989011234
            }, {
                "lightness": 11.200000000000017
            }, {
                "gamma": 1
            }]
        }, {
            "featureType": "poi.park",
            "elementType": "geometry.fill",
            "stylers": [{
                "visibility": "on"
            }, {
                "saturation": "-68"
            }, {
                "lightness": "35"
            }]
        }, {
            "featureType": "road.highway",
            "elementType": "all",
            "stylers": [{
                "hue": "#FFC200"
            }, {
                "saturation": -61.8
            }, {
                "lightness": 45.599999999999994
            }, {
                "gamma": 1
            }]
        }, {
            "featureType": "road.arterial",
            "elementType": "all",
            "stylers": [{
                "hue": "#FF0300"
            }, {
                "saturation": -100
            }, {
                "lightness": 51.19999999999999
            }, {
                "gamma": 1
            }]
        }, {
            "featureType": "road.local",
            "elementType": "all",
            "stylers": [{
                "hue": "#FF0300"
            }, {
                "saturation": -100
            }, {
                "lightness": 52
            }, {
                "gamma": 1
            }]
        }, {
            "featureType": "water",
            "elementType": "all",
            "stylers": [{
                "hue": "#0078FF"
            }, {
                "saturation": -13.200000000000003
            }, {
                "lightness": 2.4000000000000057
            }, {
                "gamma": 1
            }]
        }, {
            "featureType": "water",
            "elementType": "geometry.fill",
            "stylers": [{
                "visibility": "on"
            }, {
                "saturation": "-40"
            }]
        }]
    </script>

    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC2wDZend4lfhVc4oXgnWR-r3-xXe0UFxM"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>


    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-89707455-1', 'auto');
        ga('send', 'pageview');
    </script>

    <!-- Start Responsly Code -->

    <!-- End Responsly Code -->

</body>

</html>